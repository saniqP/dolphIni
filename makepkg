#!/bin/bash

# Конфигурация
CONFIG_DIR="$HOME/.config/goose"
SCRIPT_NAME="goose"  # Имя команды для вызова

# Устанавливаем пакеты
sudo pacman -S pypy3

# Создаем директорию конфигов
mkdir -p "$CONFIG_DIR/cmd" || { echo "Error: Cannot create config directory"; exit 1; }

# Копируем файлы проекта
cp -r ./* "$CONFIG_DIR/" || { echo "Error: Cannot copy files"; exit 1; }

# Добавляем алиас в .bashrc и .zshrc (если есть)
ALIAS_CMD="alias $SCRIPT_NAME='pypy3 $CONFIG_DIR/main.py'"

for RC_FILE in ~/.bashrc ~/.zshrc; do
    if [ -f "$RC_FILE" ]; then
        if ! grep -q "$ALIAS_CMD" "$RC_FILE"; then
            echo "$ALIAS_CMD" >> "$RC_FILE"
            echo "Alias added to $RC_FILE"
        else
            echo "Alias already exists in $RC_FILE"
        fi
    fi
done

# Даем права на исполнение главного файла
chmod +x "$CONFIG_DIR/main.py" || echo "Warning: Cannot make main.py executable"

echo ""
echo "instalation complited!"
